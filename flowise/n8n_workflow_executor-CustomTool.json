{
  "name": "n8n_workflow_executor",
  "description": "Execute n8n workflows by webhook URL. Use this to trigger automation workflows, send notifications, process data, or integrate with external services.",
  "color": "linear-gradient(rgb(255, 87, 87), rgb(255, 50, 50))",
  "iconSrc": "",
  "schema": "[{\"id\":0,\"property\":\"workflow_name\",\"description\":\"Name or description of the workflow to execute\",\"type\":\"string\",\"required\":true},{\"id\":1,\"property\":\"payload\",\"description\":\"JSON data to send to the workflow\",\"type\":\"string\",\"required\":false}]",
  "func": "/*\n* Execute n8n workflows through webhook\n* Available workflows:\n* - send_telegram_message: Send message to Telegram\n* - process_user_query: Process and log user queries\n* - create_workflow: Create new n8n workflow\n* - data_extraction: Extract and structure data\n*/\n\nconst fetch = require('node-fetch');\n\n// Map workflow names to webhook URLs (configure in Flowise variables)\nconst workflowMap = {\n    'send_telegram_message': $vars.n8n_telegram_webhook,\n    'process_user_query': $vars.n8n_query_webhook,\n    'create_workflow': $vars.n8n_create_webhook,\n    'data_extraction': $vars.n8n_extraction_webhook\n};\n\nconst webhookUrl = workflowMap[$workflow_name] || $vars.n8n_default_webhook;\n\nif (!webhookUrl) {\n    return `Error: Webhook URL not configured for workflow '${$workflow_name}'`;\n}\n\nlet payloadData = {};\nif ($payload) {\n    try {\n        payloadData = JSON.parse($payload);\n    } catch (e) {\n        payloadData = { data: $payload };\n    }\n}\n\nconst options = {\n    method: 'POST',\n    headers: {\n        'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n        workflow: $workflow_name,\n        input: payloadData,\n        source: 'flowise-agent',\n        sessionId: $flow.sessionId,\n        chatId: $flow.chatId,\n        timestamp: new Date().toISOString()\n    })\n};\n\ntry {\n    const response = await fetch(webhookUrl, options);\n    const result = await response.json();\n    return JSON.stringify(result, null, 2);\n} catch (error) {\n    console.error('n8n workflow execution error:', error);\n    return `Error executing workflow '${$workflow_name}': ${error.message}`;\n}"
}
